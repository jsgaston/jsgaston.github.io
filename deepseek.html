<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conexión DeepSeek con Python Simulado</title>
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #7209b7;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #4cc9f0;
            --warning-color: #f72585;
            --border-radius: 12px;
            --box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        h1 {
            color: var(--secondary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--accent-color);
            font-size: 1.2rem;
            font-weight: 400;
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .card-title {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            background: #f1f8ff;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        .status {
            padding: 10px 15px;
            border-radius: var(--border-radius);
            margin-top: 15px;
            display: none;
        }
        
        .status.success {
            background: #d1fae5;
            color: #065f46;
            display: block;
        }
        
        .status.error {
            background: #fee2e2;
            color: #b91c1c;
            display: block;
        }
        
        .solution-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .solution-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--box-shadow);
            transition: transform 0.3s;
        }
        
        .solution-card:hover {
            transform: translateY(-5px);
        }
        
        .solution-card h3 {
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .code-editor {
            background: #2d2d2d;
            color: #f8f8f2;
            border-radius: var(--border-radius);
            padding: 15px;
            font-family: 'Courier New', monospace;
            min-height: 300px;
            overflow: auto;
        }
        
        .code-output {
            background: #f8f8f8;
            border-radius: var(--border-radius);
            padding: 15px;
            min-height: 300px;
            overflow: auto;
            border: 1px solid #e2e8f0;
        }
        
        .python-keyword {
            color: #ff79c6;
        }
        
        .python-string {
            color: #f1fa8c;
        }
        
        .python-comment {
            color: #6272a4;
        }
        
        .python-function {
            color: #50fa7b;
        }
        
        .api-management {
            background: #f1f8ff;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .solution-options, .editor-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Conexión con DeepSeek usando Python</h1>
            <p class="subtitle">Simulación de código Python en el navegador</p>
        </header>
        
        <div class="card">
            <h2 class="card-title">Gestión de API Key</h2>
            
            <div class="api-management">
                <div class="form-group">
                    <label for="api-key">Clave API de DeepSeek</label>
                    <input type="password" id="api-key" placeholder="Ingresa tu API key">
                </div>
                
                <div class="form-group">
                    <label for="api-file">O selecciona un archivo con tu API key</label>
                    <input type="file" id="api-file" accept=".txt">
                </div>
                
                <button id="save-api">
                    Guardar API Key
                </button>
                
                <div id="api-status" class="status"></div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title">Editor de Python Simulado</h2>
            <p>Escribe o pega tu código Python para interactuar con DeepSeek API. Esta es una simulación que se ejecuta en JavaScript.</p>
            
            <div class="editor-container">
                <div class="code-editor" id="python-editor" contenteditable="true"># Simulador de Python para DeepSeek
# Escribe tu código aquí

# Leer API key del almacenamiento local
api_key = localStorage.get('deepseek_api_key')

if api_key:
    print("API Key encontrada:", api_key[:10] + "...")
else:
    print("No se encontró API Key. Guarda una primero.")

# Ejemplo de solicitud a la API
def consultar_deepseek(pregunta):
    # Simulación de una solicitud a la API
    print(f"Enviando pregunta: {pregunta}")
    
    # En un entorno real, aquí usarías requests.post()
    respuesta_simulada = f"DeepSeek responde: Has preguntado sobre '{pregunta}'. Esto es una simulación."
    
    return respuesta_simulada

# Ejemplo de uso
if api_key:
    respuesta = consultar_deepseek("¿Cómo funciona la API de DeepSeek?")
    print(respuesta)
</div>
                
                <div class="code-output" id="output">
                    <p>> El resultado de tu código aparecerá aquí</p>
                </div>
            </div>
            
            <button id="run-code">
                Ejecutar Código
            </button>
            <button id="reset-code">
                Restablecer Código
            </button>
        </div>
        
        <div class="card">
            <h2 class="card-title">Ejemplos de Código</h2>
            
            <div class="solution-options">
                <div class="solution-card">
                    <h3>Conexión Básica</h3>
                    <p>Ejemplo simple de conexión con la API</p>
                    <button onclick="loadExample('basic')">
                        Cargar Ejemplo
                    </button>
                </div>
                
                <div class="solution-card">
                    <h3>Chat Completo</h3>
                    <p>Ejemplo de conversación con DeepSeek</p>
                    <button onclick="loadExample('chat')">
                        Cargar Ejemplo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mostrar la API key guardada si existe
        window.addEventListener('DOMContentLoaded', function() {
            const savedApiKey = localStorage.getItem('deepseekapi.txt');
            if (savedApiKey) {
                document.getElementById('api-key').value = savedApiKey;
            }
            
            // Configurar el editor de código
            highlightCode();
        });
        
        // Guardar API key
        document.getElementById('save-api').addEventListener('click', function() {
            const apiKey = document.getElementById('api-key').value;
            const apiStatus = document.getElementById('api-status');
            
            if (!apiKey) {
                apiStatus.textContent = 'Por favor, ingresa una API key';
                apiStatus.classList.add('error');
                apiStatus.classList.remove('success');
                apiStatus.style.display = 'block';
                return;
            }
            
            localStorage.setItem('deepseek_api_key', apiKey);
            apiStatus.textContent = 'API Key guardada correctamente';
            apiStatus.classList.remove('error');
            apiStatus.classList.add('success');
            apiStatus.style.display = 'block';
        });
        
        // Cargar API key desde archivo
        document.getElementById('api-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const apiKey = e.target.result.trim();
                document.getElementById('api-key').value = apiKey;
                
                // Guardar automáticamente
                localStorage.setItem('deepseek_api_key', apiKey);
                document.getElementById('api-status').textContent = 'API Key cargada desde archivo y guardada';
                document.getElementById('api-status').classList.remove('error');
                document.getElementById('api-status').classList.add('success');
                document.getElementById('api-status').style.display = 'block';
            };
            reader.readAsText(file);
        });
        
        // Ejecutar código Python simulado
        document.getElementById('run-code').addEventListener('click', function() {
            const code = document.getElementById('python-editor').textContent;
            const outputElement = document.getElementById('output');
            
            outputElement.innerHTML = '<p>> Ejecutando código...</p>';
            
            // Simular ejecución con un pequeño retraso
            setTimeout(function() {
                try {
                    const result = executePythonCode(code);
                    outputElement.innerHTML = '<p>> Resultado:</p>' + result;
                } catch (error) {
                    outputElement.innerHTML = '<p style="color: red;">> Error: ' + error.message + '</p>';
                }
            }, 500);
        });
        
        // Restablecer código
        document.getElementById('reset-code').addEventListener('click', function() {
            document.getElementById('python-editor').textContent = `# Simulador de Python para DeepSeek
# Escribe tu código aquí

# Leer API key del almacenamiento local
api_key = localStorage.get('deepseek_api_key')

if api_key:
    print("API Key encontrada:", api_key[:10] + "...")
else:
    print("No se encontró API Key. Guarda una primero.")

# Ejemplo de solicitud a la API
def consultar_deepseek(pregunta):
    # Simulación de una solicitud a la API
    print(f"Enviando pregunta: {pregunta}")
    
    # En un entorno real, aquí usarías requests.post()
    respuesta_simulada = f"DeepSeek responde: Has preguntado sobre '{pregunta}'. Esto es una simulación."
    
    return respuesta_simulada

# Ejemplo de uso
if api_key:
    respuesta = consultar_deepseek("¿Cómo funciona la API de DeepSeek?")
    print(respuesta)`;
            
            highlightCode();
            document.getElementById('output').innerHTML = '<p>> El resultado de tu código aparecerá aquí</p>';
        });
        
        // Función para "ejecutar" el código Python (simulado)
        function executePythonCode(code) {
            const apiKey = localStorage.getItem('deepseek_api_key') || '';
            
            // Simular algunas funciones de Python
            const print = (...args) => {
                return args.map(arg => {
                    if (typeof arg === 'object') return JSON.stringify(arg);
                    return String(arg);
                }).join(' ') + '<br>';
            };
            
            // Simular localStorage para el código "Python"
            const localStorageSim = {
                get: (key) => {
                    if (key === 'deepseek_api_key') return apiKey;
                    return null;
                }
            };
            
            // Capturar console.log
            let output = '';
            const console = {
                log: (...args) => {
                    output += print(...args);
                }
            };
            
            // Ejecutar las funciones simuladas
            try {
                // Reemplazar funciones de Python con versiones JavaScript
                const jsCode = code
                    .replace(/print\((.*)\)/g, 'console.log($1)')
                    .replace(/localStorage\.get\(/g, 'localStorageSim.get(');
                
                // Ejecutar el código modificado
                eval(jsCode);
                
                return output || '<p>> El código se ejecutó pero no produjo output</p>';
            } catch (error) {
                throw new Error(error.message);
            }
        }
        
        // Resaltar sintaxis para el código Python
        function highlightCode() {
            const editor = document.getElementById('python-editor');
            let code = editor.textContent;
            
            // Resaltar palabras clave
            code = code.replace(/(#.*)/g, '<span class="python-comment">$1</span>');
            code = code.replace(/\b(def|if|else|return|print|for|while|in|import|from|as|True|False|None)\b/g, '<span class="python-keyword">$1</span>');
            code = code.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\(/g, '<span class="python-function">$1</span>(');
            code = code.replace(/(".*?"|'.*?')/g, '<span class="python-string">$1</span>');
            
            editor.innerHTML = code;
        }
        
        // Cargar ejemplos de código
        function loadExample(type) {
            const editor = document.getElementById('python-editor');
            
            if (type === 'basic') {
                editor.textContent = `# Conexión básica con DeepSeek API
api_key = localStorage.get('deepseek_api_key')

if not api_key:
    print("Error: No se encontró API Key")
else:
    print("Conectando con DeepSeek API...")
    print("API Key:", api_key[:8] + "..." + api_key.slice(-4))
    
    # Simular una solicitud HTTP
    import requests
    
    url = "https://api.deepseek.com/v1/chat/completions"
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json"
    }
    
    data = {
        "model": "deepseek-chat",
        "messages": [
            {"role": "user", "content": "Hola, ¿puedes ayudarme?"}
        ]
    }
    
    # response = requests.post(url, json=data, headers=headers)
    # print("Respuesta recibida:", response.json())
    
    # Simulación de respuesta
    respuesta_simulada = {
        "choices": [
            {
                "message": {
                    "content": "¡Hola! Claro que puedo ayudarte. ¿En qué necesitas asistencia?"
                }
            }
        ]
    }
    
    print("Respuesta simulada:", respuesta_simulada["choices"][0]["message"]["content"])`;
            } else if (type === 'chat') {
                editor.textContent = `# Chat completo con DeepSeek
api_key = localStorage.get('deepseek_api_key')

def chat_con_deepseek(mensaje, historial=[]):
    if not api_key:
        return "Error: No hay API Key configurada", historial
    
    # Agregar el nuevo mensaje al historial
    historial.append({"role": "user", "content": mensaje})
    
    # Preparar la solicitud
    url = "https://api.deepseek.com/v1/chat/completions"
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json"
    }
    
    data = {
        "model": "deepseek-chat",
        "messages": historial,
        "temperature": 0.7
    }
    
    # Simular envío de solicitud (en realidad sería: response = requests.post(...))
    # response = requests.post(url, json=data, headers=headers)
    # respuesta = response.json()
    
    # Simulación de respuesta
    respuesta_simulada = {
        "choices": [
            {
                "message": {
                    "content": f"Entendí tu mensaje: '{mensaje}'. Esto es una simulación de respuesta."
                }
            }
        ]
    }
    
    contenido_respuesta = respuesta_simulada["choices"][0]["message"]["content"]
    
    # Agregar la respuesta al historial
    historial.append({"role": "assistant", "content": contenido_respuesta})
    
    return contenido_respuesta, historial

# Ejemplo de conversación
historial_conversacion = []
respuesta, historial_conversacion = chat_con_deepseek("Hola, ¿cómo estás?", historial_conversacion)
print("DeepSeek:", respuesta)

respuesta, historial_conversacion = chat_con_deepseek("¿Puedes explicarme cómo funciona tu API?", historial_conversacion)
print("DeepSeek:", respuesta)`;
            }
            
            highlightCode();
        }
    </script>
</body>
</html>
