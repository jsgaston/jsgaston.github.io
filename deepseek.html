<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conexión Automática con DeepSeek</title>
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #7209b7;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #4cc9f0;
            --warning-color: #f72585;
            --border-radius: 12px;
            --box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }
        
        h1 {
            color: var(--secondary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--accent-color);
            font-size: 1.2rem;
            font-weight: 400;
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .card-title {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title svg {
            width: 24px;
            height: 24px;
        }
        
        .api-config {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .api-config {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        button.secondary {
            background: var(--light-color);
            color: var(--dark-color);
            border: 2px solid #e2e8f0;
        }
        
        button.secondary:hover {
            background: #e2e8f0;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 400px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fafbff;
        }
        
        .message {
            max-width: 80%;
            padding: 12px 18px;
            margin-bottom: 15px;
            border-radius: 18px;
            line-height: 1.5;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background: var(--primary-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .bot-message {
            background: #e2e8f0;
            color: var(--dark-color);
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }
        
        .chat-input {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 2px solid #e2e8f0;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            margin: 0;
        }
        
        .chat-input button {
            padding: 12px 20px;
        }
        
        .typing-indicator {
            display: none;
            padding: 12px 18px;
            background: #e2e8f0;
            border-radius: 18px;
            margin-right: auto;
            border-bottom-left-radius: 5px;
            width: fit-content;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .typing-indicator span {
            animation: typing 1.4s infinite;
            display: inline-block;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        
        .instructions {
            background: #f1f8ff;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 30px;
        }
        
        .instructions h3 {
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        .instructions code {
            background: #e2e8f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .status {
            padding: 10px 15px;
            border-radius: var(--border-radius);
            margin-top: 15px;
            display: none;
        }
        
        .status.success {
            background: #d1fae5;
            color: #065f46;
            display: block;
        }
        
        .status.error {
            background: #fee2e2;
            color: #b91c1c;
            display: block;
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            background: #f1f8ff;
        }
        
        .status-icon {
            width: 24px;
            height: 24px;
        }
        
        .status-icon.success {
            color: #10b981;
        }
        
        .status-icon.error {
            color: #ef4444;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Conexión Automática con DeepSeek</h1>
            <p class="subtitle">Obtención automática de la API key desde el servidor</p>
        </header>
        
        <div class="api-config">
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                    </svg>
                    Configuración de API Key
                </h2>
                
                <div class="form-group">
                    <label for="api-key">Clave API de DeepSeek</label>
                    <input type="password" id="api-key" placeholder="La API key se cargará automáticamente" readonly>
                </div>
                
                <div class="form-group">
                    <label for="api-endpoint">Endpoint de la API</label>
                    <input type="text" id="api-endpoint" value="https://api.deepseek.com/v1/chat/completions">
                </div>
                
                <div class="form-group">
                    <label for="model">Modelo</label>
                    <select id="model">
                        <option value="deepseek-chat">DeepSeek Chat</option>
                        <option value="deepseek-coder">DeepSeek Coder</option>
                    </select>
                </div>
                
                <div class="btn-group">
                    <button id="load-api-key">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                        </svg>
                        Obtener API Key del Servidor
                    </button>
                    
                    <button id="save-config" class="secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                        </svg>
                        Guardar Configuración
                    </button>
                </div>
                
                <div id="api-status" class="api-status">
                    <svg class="status-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span>API key no cargada aún</span>
                </div>
                
                <div id="config-status" class="status"></div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 01-2-2v8a2 2 0 012 2h5l-5 5v-5z" />
                    </svg>
                    Prueba de Conexión
                </h2>
                
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message bot-message">
                            ¡Hola! Una vez que cargues la API key desde el servidor, podremos comenzar a chatear.
                        </div>
                    </div>
                    
                    <div class="typing-indicator" id="typing-indicator">
                        DeepSeek está escribiendo<span>.</span><span>.</span><span>.</span>
                    </div>
                    
                    <div class="chat-input">
                        <input type="text" id="message-input" placeholder="Escribe tu mensaje..." disabled>
                        <button id="send-message" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.5.5 0 0 1-.928.086L7.5 12.5l-3.5 4.5L1 11.5l-1-1 4.5-3.5L.146 6.854a.5.5 0 0 1 .086-.928L14.714.036a.5.5 0 0 1 .54.11ZM4.5 10.5l5-5-5 5Z"/>
                            </svg>
                            Enviar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <h3>Instrucciones para la integración automática</h3>
            <ol>
                <li>Asegúrate de que el archivo <code>deepseekapi.txt</code> esté en tu servidor web</li>
                <li>Haz clic en "Obtener API Key del Servidor" para cargarla automáticamente</li>
                <li>La API key se mostrará en el campo correspondiente (enmascarada por seguridad)</li>
                <li>Guarda la configuración para almacenarla en el navegador (localStorage)</li>
                <li>¡Ya puedes comenzar a chatear con DeepSeek!</li>
                <li><strong>Nota:</strong> Necesitarás implementar un endpoint en tu servidor que sirva el archivo de forma segura</li>
            </ol>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const apiKeyInput = document.getElementById('api-key');
            const apiEndpointInput = document.getElementById('api-endpoint');
            const modelSelect = document.getElementById('model');
            const loadApiKeyBtn = document.getElementById('load-api-key');
            const saveConfigBtn = document.getElementById('save-config');
            const configStatus = document.getElementById('config-status');
            const apiStatus = document.getElementById('api-status');
            const chatMessages = document.getElementById('chat-messages');
            const messageInput = document.getElementById('message-input');
            const sendMessageBtn = document.getElementById('send-message');
            const typingIndicator = document.getElementById('typing-indicator');
            
            // Cargar configuración guardada
            const savedConfig = localStorage.getItem('deepseekConfig');
            if (savedConfig) {
                const config = JSON.parse(savedConfig);
                apiKeyInput.value = config.apiKey;
                apiEndpointInput.value = config.apiEndpoint;
                modelSelect.value = config.model;
                
                updateApiStatus(true, 'API key cargada desde almacenamiento local');
                enableChat();
            }
            
            // Función para obtener la API key del servidor
            loadApiKeyBtn.addEventListener('click', async function() {
                try {
                    // En una implementación real, esta sería la URL a tu endpoint que sirve el archivo
                    // Por ejemplo: '/api/deepseek-key' o 'https://tudominio.com/deepseekapi.txt'
                    const response = await fetch('deepseekapi.txt');
                    
                    if (!response.ok) {
                        throw new Error('No se pudo cargar el archivo');
                    }
                    
                    const apiKey = await response.text();
                    
                    if (apiKey.trim() === '') {
                        throw new Error('El archivo está vacío');
                    }
                    
                    // Guardar la API key en el campo
                    apiKeyInput.value = apiKey.trim();
                    
                    // Actualizar estado
                    updateApiStatus(true, 'API key cargada correctamente desde el servidor');
                    enableChat();
                    
                } catch (error) {
                    console.error('Error al cargar la API key:', error);
                    updateApiStatus(false, 'Error al cargar la API key: ' + error.message);
                }
            });
            
            // Guardar configuración
            saveConfigBtn.addEventListener('click', function() {
                const apiKey = apiKeyInput.value.trim();
                const apiEndpoint = apiEndpointInput.value.trim();
                const model = modelSelect.value;
                
                if (!apiKey) {
                    configStatus.textContent = 'Por favor, carga primero la API key.';
                    configStatus.classList.remove('success');
                    configStatus.classList.add('error');
                    return;
                }
                
                const config = {
                    apiKey,
                    apiEndpoint,
                    model
                };
                
                localStorage.setItem('deepseekConfig', JSON.stringify(config));
                
                configStatus.textContent = 'Configuración guardada correctamente.';
                configStatus.classList.remove('error');
                configStatus.classList.add('success');
            });
            
            // Enviar mensaje
            sendMessageBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            function sendMessage() {
                const message = messageInput.value.trim();
                if (!message) return;
                
                // Agregar mensaje del usuario al chat
                addMessage(message, 'user');
                messageInput.value = '';
                
                // Obtener configuración
                const savedConfig = localStorage.getItem('deepseekConfig');
                if (!savedConfig) {
                    addMessage('Por favor, configura tu API key primero.', 'bot');
                    return;
                }
                
                const config = JSON.parse(savedConfig);
                
                // Mostrar indicador de escritura
                typingIndicator.style.display = 'block';
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // En una implementación real, aquí harías la llamada a la API de DeepSeek
                // Esta es una simulación de la respuesta
                setTimeout(() => {
                    typingIndicator.style.display = 'none';
                    
                    // Respuesta simulada (en una implementación real, usarías la respuesta de la API)
                    const responses = [
                        "¡Hola! He recibido correctamente tu mensaje. La conexión con la API de DeepSeek está funcionando correctamente.",
                        "Interesante pregunta. Como modelo de lenguaje de DeepSeek, puedo ayudarte con diversas tareas de procesamiento de lenguaje natural.",
                        "He procesado tu solicitud. La API key se ha cargado correctamente desde el servidor y la conexión es exitosa.",
                        "Gracias por tu mensaje. La integración automática de la API key está funcionando como se esperaba."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addMessage(randomResponse, 'bot');
                }, 1500);
            }
            
            function addMessage(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message');
                messageElement.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
                messageElement.textContent = text;
                
                chatMessages.appendChild(messageElement);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            function updateApiStatus(success, message) {
                const statusIcon = apiStatus.querySelector('.status-icon');
                const statusText = apiStatus.querySelector('span');
                
                statusText.textContent = message;
                
                if (success) {
                    statusIcon.classList.add('success');
                    statusIcon.classList.remove('error');
                    statusIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />';
                } else {
                    statusIcon.classList.add('error');
                    statusIcon.classList.remove('success');
                    statusIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />';
                }
            }
            
            function enableChat() {
                messageInput.disabled = false;
                sendMessageBtn.disabled = false;
                messageInput.placeholder = "Escribe tu mensaje...";
            }
        });
    </script>
</body>
</html>
